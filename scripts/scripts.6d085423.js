"use strict";function config(a){a.when("/",{template:"<main-component></main-component>"}).when("/login",{template:"<login-component></login-component>"}).when("/projects/add",{template:"<project-add-component></project-add-component>"}).when("/projects/:id/view",{template:"<project-view-component></project-view-component>"}).when("/projects/:id/edit",{template:"<project-edit-component></project-edit-component>"}).otherwise({redirectTo:"/login"})}function run(a,b,c,d){a.globals=c.getObject("globals")||{},a.globals.currentUser&&(d.defaults.headers.common.Authorization=a.globals.currentUser.authdata),a.$on("$locationChangeStart",function(c,d,e){var f=-1===$.inArray(b.path(),["/login"]),g=a.globals.currentUser;f&&!g&&b.path("/login")})}function MainCtrl(a,b,c){function d(){g.username=a.globals.currentUser.username}function e(){b.GetAll().then(function(a){a.success?g.allProjects=a.data:c.Error(a.message)})}function f(){d(),e()}var g=this;g.allProjects=[],f()}function LoginCtrl(a,b,c){function d(){b.ClearCredentials()}var e=this;e.login=function(){e.dataLoading=!0,b.Login(e.username,e.password,function(d){d.success?(b.SetCredentials(e.username,d.data.token),a.path("/")):(c.Error(d.message),e.dataLoading=!1)})},d()}function ProjectAddCtrl(a,b,c,d){function e(){f.dataLoading=!0,c.Create(f.project).then(function(a){a.success?b.path("/"):(d.Error(a.message),f.dataLoading=!1)})}var f=this;f.addProject=e}function ProjectEditCtrl(a,b,c,d,e){function f(a){d.GetById(a).then(function(a){a.success?i.project=a.data:e.Error(a.message)})}function g(){i.dataLoading=!0,d.Update(i.project).then(function(a){a.success?b.path("/projects/"+c.id+"/view"):(e.Error(a.message),i.dataLoading=!1)})}function h(){f(c.id)}var i=this;i.updateProject=g,h()}function ProjectViewCtrl(a,b,c,d,e){function f(a){d.GetById(a).then(function(a){a.success?j.project=a.data:e.Error(a.message)})}function g(a){b.path("/projects/"+a+"/edit")}function h(a){j.dataLoading=!0,d.Delete(a).then(function(a){a.success?b.path("/"):(e.Error(a.message),j.dataLoading=!1)})}function i(){f(c.id)}var j=this;j.editProject=g,j.deleteProject=h,i()}function AuthenticationService(a,b,c,d,e){function f(b,c,d){a.post(e.UserService+"api-token-auth/",{username:b,password:c}).then(function(a){a.success=!0,d(a)},function(a){a.data&&a.data.non_field_errors&&a.data.non_field_errors.length?a.message=a.data.non_field_errors[0]:a.message="Oops! Something went wrong. Please try again.",a.success=!1,d(a)})}function g(d,e){c.globals={currentUser:{username:d,authdata:e}},a.defaults.headers.common.Authorization=e;var f=new Date;f.setDate(f.getDate()+7),b.putObject("globals",c.globals,{expires:f})}function h(){c.globals={},b.remove("globals"),a.defaults.headers.common.Authorization=""}var i={};return i.Login=f,i.SetCredentials=g,i.ClearCredentials=h,i}function FlashService(a){function b(){function b(){var b=a.flash;b&&(b.keepAfterLocationChange?b.keepAfterLocationChange=!1:delete a.flash)}a.$on("$locationChangeStart",function(){b()})}function c(b,c){a.flash={message:b,type:"success",keepAfterLocationChange:c}}function d(b,c){a.flash={message:b,type:"error",keepAfterLocationChange:c}}var e={};return e.Success=c,e.Error=d,b(),e}function ProjectService(a,b){function c(){return a.get(b.ProjectService+"projects/").then(h,i("Error getting all projects"))}function d(c){return a.get(b.ProjectService+"projects/"+c+"/").then(h,i("Error getting project by id"))}function e(c){return a.post(b.ProjectService+"projects/",c).then(h,i("Error creating project"))}function f(c){return a.put(b.ProjectService+"projects/"+c.pk+"/",c).then(h,i("Error updating project"))}function g(c){return a["delete"](b.ProjectService+"projects/"+c+"/").then(h,i("Error deleting project"))}function h(a){return a.success=!0,a}function i(a){return function(b){if(Object.keys(b.data).length){var c=b.data[Object.keys(b.data)[0]];c.length&&(a=c[0])}return{success:!1,message:a}}}var j={};return j.GetAll=c,j.GetById=d,j.Create=e,j.Update=f,j.Delete=g,j}angular.module("tangentDemoApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(config).run(run),config.$inject=["$routeProvider"],run.$inject=["$rootScope","$location","$cookies","$http"],angular.module("tangentDemoApp").component("mainComponent",{templateUrl:"views/main.html",controller:MainCtrl,controllerAs:"vm"}),MainCtrl.$inject=["$rootScope","ProjectService","FlashService"],angular.module("tangentDemoApp").component("loginComponent",{templateUrl:"views/login.html",controller:LoginCtrl,controllerAs:"vm"}),LoginCtrl.$inject=["$location","AuthenticationService","FlashService"],angular.module("tangentDemoApp").component("projectAddComponent",{templateUrl:"views/project-add.html",controller:ProjectAddCtrl,controllerAs:"vm"}),ProjectAddCtrl.$inject=["$rootScope","$location","ProjectService","FlashService"],angular.module("tangentDemoApp").component("projectEditComponent",{templateUrl:"views/project-edit.html",controller:ProjectEditCtrl,controllerAs:"vm"}),ProjectEditCtrl.$inject=["$rootScope","$location","$routeParams","ProjectService","FlashService"],angular.module("tangentDemoApp").component("projectViewComponent",{templateUrl:"views/project-view.html",controller:ProjectViewCtrl,controllerAs:"vm"}),ProjectViewCtrl.$inject=["$rootScope","$location","$routeParams","ProjectService","FlashService"],angular.module("tangentDemoApp").factory("AuthenticationService",AuthenticationService),AuthenticationService.$inject=["$http","$cookies","$rootScope","$timeout","ServiceUrls"],angular.module("tangentDemoApp").factory("FlashService",FlashService),FlashService.$inject=["$rootScope"],angular.module("tangentDemoApp").factory("ProjectService",ProjectService),ProjectService.$inject=["$http","ServiceUrls"],angular.module("tangentDemoApp").constant("ServiceUrls",{UserService:"http://userservice.staging.tangentmicroservices.com:80/",ProjectService:"http://projectservice.staging.tangentmicroservices.com:80/api/v1/"}),angular.module("tangentDemoApp").run(["$templateCache",function(a){a.put("views/_project-form.html",'<div class="form-group" ng-class="{ \'has-error\': form.title.$dirty && form.title.$error.required }"> <label for="title">Title</label> <input type="text" name="title" id="title" class="form-control" ng-model="vm.project.title" required> <span ng-show="form.title.$dirty && form.title.$error.required" class="help-block">Title is required</span> </div> <div class="form-group" ng-class="{ \'has-error\': form.description.$dirty && form.description.$error.required }"> <label for="description">Description</label> <input type="text" name="description" id="description" class="form-control" ng-model="vm.project.description" required> <span ng-show="form.description.$dirty && form.description.$error.required" class="help-block">Description is required</span> </div> <div class="form-group" ng-class="{ \'has-error\': form.description.$dirty && form.description.$error.required }"> <label for="start_date">Start date</label> <input type="text" name="start_date" id="start_date" class="form-control" ng-model="vm.project.start_date" required> <span ng-show="form.start_date.$dirty && form.start_date.$error.required" class="help-block">Start date is required</span> </div> <div class="form-group" ng-class="{ \'has-error\': form.description.$dirty && form.description.$error.required }"> <label for="end_date">End date</label> <input type="text" name="end_date" id="end_date" class="form-control" ng-model="vm.project.end_date" required> <span ng-show="form.end_date.$dirty && form.end_date.$error.required" class="help-block">End date is required</span> </div> <div class="form-group" ng-class="{ \'has-error\': form.description.$dirty && form.description.$error.required }"> <label for="is_active">Active</label> <input type="checkbox" ng-model="vm.project.is_active"> </div> <div class="form-group" ng-class="{ \'has-error\': form.description.$dirty && form.description.$error.required }"> <label for="is_billable">Billable</label> <input type="checkbox" ng-model="vm.project.is_billable"> </div> <div class="form-actions"> <button type="submit" ng-disabled="form.$invalid || vm.dataLoading" class="btn btn-primary">Save</button> <img ng-if="vm.dataLoading" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="> </div>'),a.put("views/login.html",'<div class="col-md-6 col-md-offset-3"> <h2>Login</h2> <form name="form" ng-submit="vm.login()" role="form"> <div class="form-group" ng-class="{ \'has-error\': form.username.$dirty && form.username.$error.required }"> <label for="username">Username</label> <input type="text" name="username" id="username" class="form-control" ng-model="vm.username" required> <span ng-show="form.username.$dirty && form.username.$error.required" class="help-block">Username is required</span> </div> <div class="form-group" ng-class="{ \'has-error\': form.password.$dirty && form.password.$error.required }"> <label for="password">Password</label> <input type="password" name="password" id="password" class="form-control" ng-model="vm.password" required> <span ng-show="form.password.$dirty && form.password.$error.required" class="help-block">Password is required</span> </div> <div class="form-actions"> <button type="submit" ng-disabled="form.$invalid || vm.dataLoading" class="btn btn-primary">Login</button> <img ng-if="vm.dataLoading" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="> </div> </form> </div>'),a.put("views/main.html",'<div class="row"> <div class="col-md-10"><h1>Hi {{vm.username}}</h1></div> <p class="col-md-2 text-right"><a href="#/login" class="btn btn-default btn-logout">Logout</a></p> </div> <h3>Projects</h3> <a href="#/projects/add" class="btn btn-primary">Add new</a><br> <br> <div class="list-group"> <div class="list-group-item" ng-repeat="project in vm.allProjects"> <h4 class="list-group-item-heading">{{project.title}}</h4> <p class="list-group-item-text"> <dl class="dl-horizontal"> <dt>Description</dt><dd>{{project.description}}</dd> </dl> <a href="#/projects/{{project.pk}}/view" class="btn btn-primary">View</a> </p> </div> </div>'),a.put("views/project-add.html",'<div class="row"> <div class="col-md-10"><h3>New project</h3></div> <p class="col-md-2 text-right"><a href="#/" class="btn btn-default btn-form">Back</a></p> </div> <form name="form" ng-submit="vm.addProject()" role="form"> <div ng-include="\'views/_project-form.html\'"></div> </form>'),a.put("views/project-edit.html",'<div class="row"> <div class="col-md-10"><h3>Edit project</h3></div> <p class="col-md-2 text-right"><a href="#/projects/{{vm.project.pk}}/view" class="btn btn-default btn-form">Back</a></p> </div> <form name="form" ng-submit="vm.updateProject()" role="form"> <div ng-include="\'views/_project-form.html\'"></div> </form>'),a.put("views/project-view.html",'<div class="row"> <div class="col-md-10"><h3>View project</h3></div> <p class="col-md-2 text-right"><a href="#/" class="btn btn-default btn-form">Back</a></p> </div> <div class="list-group"> <div class="list-group-item"> <h4 class="list-group-item-heading">{{vm.project.title}}</h4> <p class="list-group-item-text"> <dl class="dl-horizontal"> <dt>Description</dt><dd>{{vm.project.description}}</dd> <dt>Start date</dt><dd>{{vm.project.start_date}}</dd> <dt>End date</dt><dd>{{vm.project.end_date}}</dd> <dt>Active</dt><dd><input type="checkbox" ng-model="vm.project.is_active" disabled></dd> <dt>Billable</dt><dd><input type="checkbox" ng-model="vm.project.is_billable" disabled></dd> </dl> <button ng-click="vm.editProject(vm.project.pk)" type="button" ng-disabled="vm.dataLoading" class="btn btn-primary">Edit</button> <button type="button" ng-disabled="vm.dataLoading" class="btn btn-default" data-toggle="modal" data-target="#confirm-delete">Delete</button> <img ng-if="vm.dataLoading" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="> </p> </div> </div> <div class="modal fade" id="confirm-delete" tabindex="-1" role="dialog" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <h3>Confirm delete</h3> </div> <div class="modal-body"> Are you sure? </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button> <a ng-click="vm.deleteProject(vm.project.pk)" class="btn btn-danger btn-ok" data-dismiss="modal">Delete</a> </div> </div> </div> </div>')}]);